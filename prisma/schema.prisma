generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String         @id @default(uuid())
  email         String         @unique
  password      String
  name          String
  role          UserRole       @default(USER)
  phone         String?
  country       String?
  governorate   String?
  city          String?
  streetAddress String?
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
}

model Product {
  id                  String        @id @default(cuid())
  title               String        @unique
  description         String
  categories          Category[]    @relation("ProductCategories")
  brand               Brand?        @relation(fields: [brandId], references: [id])
  brandId             String?
  price               Decimal
  discountPercentage  Float?
  rating              Float
  stock               Int
  limit               Int?
  images              String[]
  thumbnail           String
  createdAt           DateTime      @default(now())
  updatedAt           DateTime      @updatedAt
}

model Category {
  id              String        @id @default(uuid())
  name            String        @unique
  slug            String        @unique
  subCategoryName String
  thumbnail       String
  products        Product[]     @relation("ProductCategories")
  parentId        String?
  parent          Category?     @relation("CategoryToCategory", fields: [parentId], references: [id])
  children        Category[]    @relation("CategoryToCategory")
  brands          Brand[]
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt

  @@index([slug])
}

model Brand {
  id         String    @id @default(uuid())
  name       String    @unique
  slug       String    @unique
  thumbnail  String?
  products   Product[]
  categories Category[]

  @@index([slug])
}

enum UserRole {
  USER
  ADMIN
}